#!/bin/bash

#Bbash script to move pertinent files from jobs and pull file names
#param h - put jobs containing this string into list
#param i - ignore jobs that contain this string

SETRUN_ARGS="$@"
hinge="DefaultHinge"
ignore_string="DefaultIgnore"
en="potenergy"
vol="volume"
iter=0
iterspace=1
declare -a ennames
declare -a volnames
declare -a psamp

#options passed in from the users
while getopts "h:i:" opt; do
        case $opt in
        h )
                hinge=$OPTARG
                ;;
        i )
                ignore_string=$OPTARG
                ;;
	esac
done




#Move all jobs
if [ "$hinge" == "DefaultHinge" ] && [ $ignore_string == "DefaultIgnore" ]; then
	for direct in $(ls -l | egrep '^d' | awk '{print $9}'); do
			
		a="polymorph"
		if [ echo $direct | grep "p1" == $direct ]; then
			b= "p1"
		fi

		elif [ echo $direct | grep "p2" == $direct ]; then
			b= "p2"
		fi

		else 
			b= "p2"
		fi
		c="pressure"
		d=$( less benzene_production.mdp | grep "ref_p" | awk '{print $3}' )
		x="vol"
		y="en"
		newnameen="$a$b$c$d$y"
		newnamevol="$a$b$c$d$x"
		$ennames[$iter]=$newnameen
		$volnames[$iter]=$newnamevol

		for file in $(ls -l | egrep '^d' | awk '{print $9}' | grep "$(echo $en | awk '{print $1}')" | grep "$(echo $en | awk '{print $2}')" | grep "$(echo $en | awk '{print $3}')"); do
			scp -r $file ~/anaconda/benzenephase/envolfiles
			mv $file $newnameen

		done


		for file in $(ls -l | egrep '^d' | awk '{print $9}' | grep "$(echo $vol | awk '{print $1}')" | grep "$(echo $vol | awk '{print $2}')" | grep "$(echo $vol | awk '{print $3}')"); do
			w="polymorph"
			scp -r $file ~/anaconda/benzenephase/envolfiles
			mv $file $newnamevol
		done

		let "iter=$iter+$iterspacing"
	done
fi






